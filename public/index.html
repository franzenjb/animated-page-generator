<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KINETIC.LAB // AI-Powered Animation Generator</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.0/dist/confetti.browser.min.js"></script>

    <style>
        /* ============================================
           DESIGN TOKENS
           ============================================ */
        :root {
            /* Backgrounds */
            --bg-deep: #050510;
            --bg-surface: #0a0a1a;
            --bg-elevated: #12121f;

            /* Aurora Gradients */
            --aurora-purple: #7c3aed;
            --aurora-cyan: #06b6d4;
            --aurora-magenta: #ec4899;
            --aurora-blue: #3b82f6;

            /* Accents */
            --accent-primary: #a855f7;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-error: #ef4444;

            /* Text */
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #52525b;

            /* Glass */
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-blur: 20px;

            /* Spacing */
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 12px;
            --space-4: 16px;
            --space-5: 24px;
            --space-6: 32px;
            --space-7: 48px;
            --space-8: 64px;

            /* Easing */
            --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
            --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* ============================================
           BASE STYLES
           ============================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-deep);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ============================================
           AURORA BACKGROUND
           ============================================ */
        .aurora-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .aurora-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(100px);
            opacity: 0.4;
            animation: float 20s ease-in-out infinite;
        }

        .orb-1 {
            width: 600px;
            height: 600px;
            background: var(--aurora-purple);
            top: -200px;
            left: -100px;
            animation-delay: 0s;
        }

        .orb-2 {
            width: 500px;
            height: 500px;
            background: var(--aurora-cyan);
            top: 50%;
            right: -150px;
            animation-delay: -5s;
        }

        .orb-3 {
            width: 400px;
            height: 400px;
            background: var(--aurora-magenta);
            bottom: -100px;
            left: 30%;
            animation-delay: -10s;
        }

        .orb-4 {
            width: 350px;
            height: 350px;
            background: var(--aurora-blue);
            top: 30%;
            left: 50%;
            animation-delay: -15s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(50px, -30px) scale(1.1); }
            50% { transform: translate(-30px, 50px) scale(0.9); }
            75% { transform: translate(-50px, -20px) scale(1.05); }
        }

        /* ============================================
           PARTICLE CANVAS
           ============================================ */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        /* ============================================
           SCROLL PROGRESS
           ============================================ */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--aurora-purple), var(--aurora-cyan), var(--aurora-magenta));
            z-index: 1000;
            transform-origin: left;
            transform: scaleX(0);
        }

        /* ============================================
           FLOATING NAV
           ============================================ */
        .floating-nav {
            position: fixed;
            top: var(--space-5);
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            display: flex;
            gap: var(--space-2);
            padding: var(--space-2);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            opacity: 0;
            transform: translateX(-50%) translateY(-20px);
            transition: opacity 0.3s, transform 0.3s;
        }

        .floating-nav.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .nav-btn {
            padding: var(--space-2) var(--space-4);
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.2s var(--ease-smooth);
        }

        .nav-btn:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-btn.active {
            color: var(--text-primary);
            background: var(--aurora-purple);
        }

        /* ============================================
           SECTIONS
           ============================================ */
        section {
            position: relative;
            z-index: 10;
        }

        /* ============================================
           HERO SECTION
           ============================================ */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: var(--space-8);
            position: relative;
        }

        .hero-logo {
            display: flex;
            gap: 8px;
            margin-bottom: var(--space-5);
        }

        .logo-letter {
            font-size: clamp(48px, 12vw, 120px);
            font-weight: 900;
            letter-spacing: -0.04em;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--aurora-purple) 50%, var(--aurora-cyan) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            opacity: 0;
            transform: translateY(50px) rotateX(-45deg);
        }

        .logo-dot {
            font-size: clamp(48px, 12vw, 120px);
            font-weight: 900;
            color: var(--aurora-magenta);
            opacity: 0;
            transform: scale(0);
        }

        .hero-tagline {
            font-size: clamp(16px, 3vw, 24px);
            font-weight: 300;
            color: var(--text-secondary);
            margin-bottom: var(--space-7);
            opacity: 0;
            max-width: 600px;
        }

        .hero-cta {
            display: flex;
            gap: var(--space-4);
            opacity: 0;
        }

        .btn-primary {
            padding: var(--space-4) var(--space-6);
            background: linear-gradient(135deg, var(--aurora-purple), var(--aurora-magenta));
            border: none;
            border-radius: 50px;
            color: white;
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(168, 85, 247, 0.4);
        }

        .btn-secondary {
            padding: var(--space-4) var(--space-6);
            background: transparent;
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
        }

        .btn-secondary:hover {
            border-color: var(--aurora-cyan);
            background: rgba(6, 182, 212, 0.1);
        }

        .scroll-indicator {
            position: absolute;
            bottom: var(--space-7);
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-2);
            color: var(--text-muted);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0;
        }

        .scroll-indicator svg {
            width: 24px;
            height: 24px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(8px); }
        }

        /* ============================================
           SHOWCASE SECTION
           ============================================ */
        .showcase {
            min-height: 100vh;
            padding: var(--space-8) var(--space-5);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .section-header {
            text-align: center;
            margin-bottom: var(--space-7);
        }

        .section-title {
            font-size: clamp(32px, 6vw, 56px);
            font-weight: 800;
            letter-spacing: -0.03em;
            margin-bottom: var(--space-3);
        }

        .section-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
        }

        .carousel-container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            perspective: 1000px;
        }

        .carousel {
            display: flex;
            gap: var(--space-5);
            padding: var(--space-5);
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .carousel::-webkit-scrollbar {
            display: none;
        }

        .carousel-card {
            flex: 0 0 300px;
            height: 400px;
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s var(--ease-smooth);
            position: relative;
            scroll-snap-align: center;
        }

        .carousel-card:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: var(--aurora-purple);
            box-shadow: 0 20px 60px rgba(124, 58, 237, 0.3);
        }

        .carousel-card-preview {
            width: 100%;
            height: 280px;
            background: linear-gradient(135deg, var(--bg-surface), var(--bg-elevated));
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .carousel-card-preview iframe {
            width: 100%;
            height: 100%;
            border: none;
            pointer-events: none;
            transform: scale(0.5);
            transform-origin: center center;
        }

        .carousel-card-info {
            padding: var(--space-4);
        }

        .carousel-card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: var(--space-1);
        }

        .carousel-card-desc {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* ============================================
           GENERATOR SECTION
           ============================================ */
        .generator {
            min-height: 100vh;
            padding: var(--space-8) var(--space-5);
        }

        .generator-workspace {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-6);
            align-items: start;
        }

        @media (max-width: 1024px) {
            .generator-workspace {
                grid-template-columns: 1fr;
            }
        }

        .generator-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: var(--space-6);
        }

        .panel-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
            margin-bottom: var(--space-4);
        }

        /* Prompt Input */
        .prompt-container {
            position: relative;
        }

        .prompt-input {
            width: 100%;
            min-height: 160px;
            padding: var(--space-4);
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--glass-border);
            border-radius: 16px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 15px;
            line-height: 1.6;
            resize: none;
            transition: all 0.3s var(--ease-smooth);
        }

        .prompt-input:focus {
            outline: none;
            border-color: var(--aurora-purple);
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.2);
        }

        .prompt-input::placeholder {
            color: var(--text-muted);
        }

        .char-count {
            position: absolute;
            bottom: var(--space-3);
            right: var(--space-3);
            font-size: 11px;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        /* Suggestions */
        .suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-2);
            margin-top: var(--space-4);
        }

        .suggestion-pill {
            padding: var(--space-2) var(--space-3);
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 20px;
            color: var(--aurora-purple);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s var(--ease-smooth);
        }

        .suggestion-pill:hover {
            background: rgba(124, 58, 237, 0.2);
            border-color: var(--aurora-purple);
        }

        /* Generate Buttons */
        .generate-actions {
            display: flex;
            gap: var(--space-3);
            margin-top: var(--space-5);
        }

        .btn-generate {
            flex: 1;
            padding: var(--space-4) var(--space-5);
            background: linear-gradient(135deg, var(--aurora-purple), var(--aurora-cyan));
            border: none;
            border-radius: 12px;
            color: white;
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
        }

        .btn-generate:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.4);
        }

        .btn-generate:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-generate.loading {
            pointer-events: none;
        }

        .btn-generate .spinner {
            display: none;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .btn-generate.loading .spinner {
            display: block;
        }

        .btn-generate.loading .btn-text {
            display: none;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .btn-surprise {
            padding: var(--space-4) var(--space-5);
            background: transparent;
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .btn-surprise:hover {
            border-color: var(--aurora-magenta);
            background: rgba(236, 72, 153, 0.1);
        }

        /* Preview Panel */
        .preview-frame {
            position: relative;
            width: 100%;
            height: 500px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 16px;
            overflow: hidden;
        }

        .preview-frame iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .preview-empty {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: var(--text-muted);
        }

        .preview-empty svg {
            width: 64px;
            height: 64px;
            margin-bottom: var(--space-4);
            opacity: 0.3;
        }

        .preview-empty h3 {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: var(--space-2);
        }

        .preview-empty p {
            font-size: 13px;
        }

        /* Skeleton Loader */
        .skeleton-loader {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-surface);
            display: none;
        }

        .skeleton-loader.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--space-4);
        }

        .skeleton-pulse {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--aurora-purple), var(--aurora-cyan));
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 1; }
        }

        .skeleton-text {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Preview Actions */
        .preview-actions {
            display: flex;
            gap: var(--space-3);
            margin-top: var(--space-4);
        }

        .action-btn {
            flex: 1;
            padding: var(--space-3) var(--space-4);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s var(--ease-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
        }

        .action-btn:hover:not(:disabled) {
            border-color: var(--aurora-purple);
            color: var(--text-primary);
            background: rgba(124, 58, 237, 0.1);
        }

        .action-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .action-btn svg {
            width: 16px;
            height: 16px;
        }

        /* ============================================
           GALLERY SECTION
           ============================================ */
        .gallery {
            min-height: 100vh;
            padding: var(--space-8) var(--space-5);
        }

        .gallery-grid {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-5);
        }

        .gallery-empty {
            grid-column: 1 / -1;
            text-align: center;
            padding: var(--space-8);
            color: var(--text-muted);
        }

        .gallery-empty svg {
            width: 80px;
            height: 80px;
            margin-bottom: var(--space-4);
            opacity: 0.2;
        }

        .gallery-card {
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
        }

        .gallery-card:hover {
            transform: translateY(-5px);
            border-color: var(--aurora-purple);
            box-shadow: 0 15px 40px rgba(124, 58, 237, 0.2);
        }

        .gallery-card-preview {
            width: 100%;
            height: 180px;
            background: var(--bg-surface);
            overflow: hidden;
        }

        .gallery-card-preview iframe {
            width: 200%;
            height: 200%;
            border: none;
            pointer-events: none;
            transform: scale(0.5);
            transform-origin: top left;
        }

        .gallery-card-info {
            padding: var(--space-4);
        }

        .gallery-card-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: var(--space-1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .gallery-card-date {
            font-size: 11px;
            color: var(--text-muted);
        }

        .gallery-card-prompt {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .gallery-card-actions {
            display: flex;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-4);
            border-top: 1px solid var(--glass-border);
        }

        .gallery-action {
            flex: 1;
            padding: var(--space-2);
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 11px;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .gallery-action:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .gallery-action.delete:hover {
            color: var(--accent-error);
            background: rgba(239, 68, 68, 0.1);
        }

        /* ============================================
           TOAST NOTIFICATIONS
           ============================================ */
        .toast-container {
            position: fixed;
            bottom: var(--space-5);
            right: var(--space-5);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }

        .toast {
            padding: var(--space-4) var(--space-5);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: var(--space-3);
            transform: translateX(120%);
            transition: transform 0.3s var(--ease-smooth);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-color: var(--accent-success);
        }

        .toast.error {
            border-color: var(--accent-error);
        }

        .toast-icon {
            width: 20px;
            height: 20px;
        }

        .toast.success .toast-icon {
            color: var(--accent-success);
        }

        .toast.error .toast-icon {
            color: var(--accent-error);
        }

        /* ============================================
           MODALS
           ============================================ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s var(--ease-smooth);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-elevated);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: var(--space-6);
            width: 90%;
            max-width: 400px;
            transform: scale(0.9) translateY(20px);
            transition: transform 0.3s var(--ease-smooth);
        }

        .modal-overlay.active .modal {
            transform: scale(1) translateY(0);
        }

        .modal h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: var(--space-4);
        }

        .modal p {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: var(--space-5);
        }

        .modal-input {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 14px;
            margin-bottom: var(--space-5);
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--aurora-purple);
        }

        .modal-actions {
            display: flex;
            gap: var(--space-3);
            justify-content: flex-end;
        }

        .modal-btn {
            padding: var(--space-3) var(--space-5);
            border-radius: 10px;
            font-family: inherit;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-btn.cancel {
            background: transparent;
            border: 1px solid var(--glass-border);
            color: var(--text-secondary);
        }

        .modal-btn.cancel:hover {
            border-color: var(--text-muted);
            color: var(--text-primary);
        }

        .modal-btn.confirm {
            background: var(--aurora-purple);
            border: none;
            color: white;
        }

        .modal-btn.confirm:hover {
            background: var(--aurora-magenta);
        }

        .modal-btn.danger {
            background: var(--accent-error);
            border: none;
            color: white;
        }

        /* ============================================
           RESPONSIVE
           ============================================ */
        @media (max-width: 768px) {
            .hero-logo {
                flex-wrap: wrap;
                justify-content: center;
            }

            .hero-cta {
                flex-direction: column;
                width: 100%;
                max-width: 300px;
            }

            .carousel {
                flex-direction: column;
                align-items: center;
            }

            .generator-workspace {
                grid-template-columns: 1fr;
            }

            .floating-nav {
                bottom: var(--space-5);
                top: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Aurora Background -->
    <div class="aurora-bg">
        <div class="aurora-orb orb-1"></div>
        <div class="aurora-orb orb-2"></div>
        <div class="aurora-orb orb-3"></div>
        <div class="aurora-orb orb-4"></div>
    </div>

    <!-- Particle Canvas -->
    <canvas id="particles"></canvas>

    <!-- Scroll Progress -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Floating Navigation -->
    <nav class="floating-nav" id="floatingNav">
        <button class="nav-btn active" data-section="hero">Home</button>
        <button class="nav-btn" data-section="showcase">Showcase</button>
        <button class="nav-btn" data-section="generator">Create</button>
        <button class="nav-btn" data-section="gallery">Library</button>
    </nav>

    <!-- HERO SECTION -->
    <section class="hero" id="hero">
        <div class="hero-logo" id="heroLogo">
            <span class="logo-letter">K</span>
            <span class="logo-letter">I</span>
            <span class="logo-letter">N</span>
            <span class="logo-letter">E</span>
            <span class="logo-letter">T</span>
            <span class="logo-letter">I</span>
            <span class="logo-letter">C</span>
            <span class="logo-dot">.</span>
            <span class="logo-letter">L</span>
            <span class="logo-letter">A</span>
            <span class="logo-letter">B</span>
        </div>

        <p class="hero-tagline" id="heroTagline">
            Generate stunning, award-worthy animations with the power of AI.
            Describe your vision. Watch it come alive.
        </p>

        <div class="hero-cta" id="heroCta">
            <button class="btn-primary" onclick="scrollToSection('generator')">Start Creating</button>
            <button class="btn-secondary" onclick="scrollToSection('showcase')">See Examples</button>
        </div>

        <div class="scroll-indicator" id="scrollIndicator">
            <span>Scroll to explore</span>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M7 13l5 5 5-5M7 6l5 5 5-5"/>
            </svg>
        </div>
    </section>

    <!-- SHOWCASE SECTION -->
    <section class="showcase" id="showcase">
        <div class="section-header">
            <h2 class="section-title">What Will You Create?</h2>
            <p class="section-subtitle">Explore possibilities. Get inspired. Push boundaries.</p>
        </div>

        <div class="carousel-container">
            <div class="carousel" id="carousel">
                <!-- Cards will be populated by JS -->
            </div>
        </div>
    </section>

    <!-- GENERATOR SECTION -->
    <section class="generator" id="generator">
        <div class="section-header">
            <h2 class="section-title">Create Magic</h2>
            <p class="section-subtitle">Describe your animation and let AI bring it to life</p>
        </div>

        <div class="generator-workspace">
            <!-- Input Panel -->
            <div class="generator-panel">
                <div class="panel-title">Your Vision</div>

                <div class="prompt-container">
                    <textarea
                        class="prompt-input"
                        id="promptInput"
                        placeholder="A cosmic galaxy with swirling nebulae, twinkling stars that respond to mouse movement, and a pulsing supernova at the center..."
                        maxlength="1000"
                    ></textarea>
                    <span class="char-count" id="charCount">0/1000</span>
                </div>

                <div class="suggestions">
                    <button class="suggestion-pill" data-prompt="A cosmic clock with orbiting planets as hour markers, pulsing with light">Cosmic</button>
                    <button class="suggestion-pill" data-prompt="Kinetic typography with the word 'MOTION' where each letter floats and responds to mouse">Typography</button>
                    <button class="suggestion-pill" data-prompt="A particle system that forms and reforms into different geometric shapes">Particles</button>
                    <button class="suggestion-pill" data-prompt="An abstract data visualization with orbiting circles of different sizes">Data Viz</button>
                    <button class="suggestion-pill" data-prompt="Morphing organic blob that transforms between Matisse-inspired shapes">Organic</button>
                </div>

                <div class="generate-actions">
                    <button class="btn-generate" id="generateBtn">
                        <span class="spinner"></span>
                        <span class="btn-text">Generate Animation</span>
                    </button>
                    <button class="btn-surprise" id="surpriseBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"/>
                        </svg>
                        Surprise Me
                    </button>
                </div>
            </div>

            <!-- Preview Panel -->
            <div class="generator-panel">
                <div class="panel-title">Live Preview</div>

                <div class="preview-frame" id="previewFrame">
                    <div class="preview-empty" id="previewEmpty">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
                            <path d="M7 12h2v5H7zm4-3h2v8h-2zm4-3h2v11h-2z"/>
                        </svg>
                        <h3>Your creation awaits</h3>
                        <p>Enter a prompt and click Generate</p>
                    </div>

                    <div class="skeleton-loader" id="skeletonLoader">
                        <div class="skeleton-pulse"></div>
                        <span class="skeleton-text">Generating your animation...</span>
                    </div>

                    <iframe id="previewIframe" style="display: none;"></iframe>
                </div>

                <div class="preview-actions">
                    <button class="action-btn" id="saveBtn" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/>
                            <polyline points="17 21 17 13 7 13 7 21"/>
                            <polyline points="7 3 7 8 15 8"/>
                        </svg>
                        Save
                    </button>
                    <button class="action-btn" id="copyBtn" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                        </svg>
                        Copy
                    </button>
                    <button class="action-btn" id="downloadBtn" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Download
                    </button>
                    <button class="action-btn" id="openBtn" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/>
                            <polyline points="15 3 21 3 21 9"/>
                            <line x1="10" y1="14" x2="21" y2="3"/>
                        </svg>
                        Open
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- GALLERY SECTION -->
    <section class="gallery" id="gallery">
        <div class="section-header">
            <h2 class="section-title">Your Library</h2>
            <p class="section-subtitle">All your saved creations in one place</p>
        </div>

        <div class="gallery-grid" id="galleryGrid">
            <!-- Will be populated by JS -->
        </div>
    </section>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Rename Modal -->
    <div class="modal-overlay" id="renameModal">
        <div class="modal">
            <h3>Rename Animation</h3>
            <input type="text" class="modal-input" id="renameInput" placeholder="Enter new name">
            <div class="modal-actions">
                <button class="modal-btn cancel" id="renameCancelBtn">Cancel</button>
                <button class="modal-btn confirm" id="renameConfirmBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <h3>Delete Animation?</h3>
            <p>This action cannot be undone. Your animation will be permanently removed.</p>
            <div class="modal-actions">
                <button class="modal-btn cancel" id="deleteCancelBtn">Cancel</button>
                <button class="modal-btn danger" id="deleteConfirmBtn">Delete</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // REGISTER GSAP PLUGINS
        // ============================================
        gsap.registerPlugin(ScrollTrigger);

        // ============================================
        // PARTICLE SYSTEM
        // ============================================
        const canvas = document.getElementById('particles');
        const ctx = canvas.getContext('2d');
        let particles = [];
        const mouse = { x: -1000, y: -1000 };

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        function createParticles() {
            particles = [];
            const count = Math.min(150, Math.floor((canvas.width * canvas.height) / 15000));

            for (let i = 0; i < count; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    vx: (Math.random() - 0.5) * 0.3,
                    vy: (Math.random() - 0.5) * 0.3,
                    size: Math.random() * 2 + 1,
                    alpha: Math.random() * 0.5 + 0.2,
                    color: ['#7c3aed', '#06b6d4', '#ec4899', '#3b82f6'][Math.floor(Math.random() * 4)]
                });
            }
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            particles.forEach(p => {
                // Mouse repulsion
                const dx = p.x - mouse.x;
                const dy = p.y - mouse.y;
                const dist = Math.sqrt(dx * dx + dy * dy);

                if (dist < 150) {
                    const force = (150 - dist) / 150;
                    p.vx += (dx / dist) * force * 0.5;
                    p.vy += (dy / dist) * force * 0.5;
                }

                // Apply velocity with friction
                p.x += p.vx;
                p.y += p.vy;
                p.vx *= 0.98;
                p.vy *= 0.98;

                // Wrap around edges
                if (p.x < 0) p.x = canvas.width;
                if (p.x > canvas.width) p.x = 0;
                if (p.y < 0) p.y = canvas.height;
                if (p.y > canvas.height) p.y = 0;

                // Draw particle
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.alpha;
                ctx.fill();
            });

            ctx.globalAlpha = 1;
            requestAnimationFrame(animateParticles);
        }

        window.addEventListener('resize', () => {
            resizeCanvas();
            createParticles();
        });

        window.addEventListener('mousemove', e => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
        });

        resizeCanvas();
        createParticles();
        animateParticles();

        // ============================================
        // HERO ANIMATIONS
        // ============================================
        const heroTL = gsap.timeline({ delay: 0.3 });

        heroTL
            .to('.logo-letter', {
                opacity: 1,
                y: 0,
                rotateX: 0,
                stagger: 0.06,
                duration: 0.8,
                ease: 'back.out(1.7)'
            })
            .to('.logo-dot', {
                opacity: 1,
                scale: 1,
                duration: 0.4,
                ease: 'back.out(2)'
            }, '-=0.3')
            .to('#heroTagline', {
                opacity: 1,
                y: 0,
                duration: 0.6,
                ease: 'power2.out'
            }, '-=0.2')
            .to('#heroCta', {
                opacity: 1,
                y: 0,
                duration: 0.6,
                ease: 'power2.out'
            }, '-=0.3')
            .to('#scrollIndicator', {
                opacity: 1,
                duration: 0.4
            }, '-=0.2');

        // Hide scroll indicator on scroll
        ScrollTrigger.create({
            start: 100,
            onEnter: () => gsap.to('#scrollIndicator', { opacity: 0, duration: 0.3 }),
            onLeaveBack: () => gsap.to('#scrollIndicator', { opacity: 1, duration: 0.3 })
        });

        // ============================================
        // SCROLL PROGRESS
        // ============================================
        gsap.to('#scrollProgress', {
            scaleX: 1,
            ease: 'none',
            scrollTrigger: {
                trigger: document.body,
                start: 'top top',
                end: 'bottom bottom',
                scrub: 0.3
            }
        });

        // ============================================
        // FLOATING NAV
        // ============================================
        const floatingNav = document.getElementById('floatingNav');
        const navBtns = floatingNav.querySelectorAll('.nav-btn');

        // Show nav after scroll
        ScrollTrigger.create({
            start: 200,
            onEnter: () => floatingNav.classList.add('visible'),
            onLeaveBack: () => floatingNav.classList.remove('visible')
        });

        // Update active state
        const sections = ['hero', 'showcase', 'generator', 'gallery'];
        sections.forEach(id => {
            ScrollTrigger.create({
                trigger: `#${id}`,
                start: 'top center',
                end: 'bottom center',
                onEnter: () => setActiveNav(id),
                onEnterBack: () => setActiveNav(id)
            });
        });

        function setActiveNav(id) {
            navBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.section === id);
            });
        }

        navBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                scrollToSection(btn.dataset.section);
            });
        });

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // ============================================
        // SHOWCASE CAROUSEL - LIVE PREVIEWS
        // ============================================
        const showcaseExamples = [
            {
                title: 'Neon Cyberpunk',
                desc: 'Glitch effects and neon rain',
                file: '/showcase/neon-cyberpunk.html',
                prompt: 'A cyberpunk city with neon rain falling, glowing signs that flicker, and glitch effects on click. Rain particles react to mouse movement.'
            },
            {
                title: 'Aurora Dreamscape',
                desc: 'Flowing particles and aurora waves',
                file: '/showcase/aurora-dreamscape.html',
                prompt: 'An aurora borealis effect with 1000+ flowing particles that swirl around the mouse cursor. Click creates ripples in the aurora. Mountain silhouettes with parallax.'
            },
            {
                title: 'Deep Ocean Abyss',
                desc: 'Bioluminescent jellyfish',
                file: '/showcase/deep-ocean.html',
                prompt: 'A deep ocean scene with bioluminescent jellyfish that flee from the mouse cursor. Click releases bubbles. Caustic light rays and whale silhouettes.'
            },
            {
                title: 'Starfield Hyperdrive',
                desc: 'Warp speed through space',
                file: '/showcase/starfield-hyperdrive.html',
                prompt: 'A 2000+ star field that accelerates toward the mouse cursor. Click engages hyperdrive with warp speed streaks. Nebula clouds drift in background.'
            },
            {
                title: 'Liquid Mercury',
                desc: 'Metaball physics simulation',
                file: '/showcase/liquid-mercury.html',
                prompt: 'Liquid mercury metaballs that follow the mouse with spring physics. Click creates ripples that push the blobs apart. Iridescent chrome reflections.'
            },
            {
                title: 'Enchanted Fireflies',
                desc: 'Magical forest at night',
                file: '/showcase/fireflies.html',
                prompt: 'A magical forest with 200+ fireflies attracted to the mouse cursor. Click scatters them with sparkle effects. Trees sway gently, fog layers drift.'
            },
            {
                title: 'Infinite Kaleidoscope',
                desc: 'Evolving geometric patterns',
                file: '/showcase/kaleidoscope.html',
                prompt: 'An infinite kaleidoscope that rotates based on mouse position. Click increases complexity and changes the pattern. Full spectrum color cycling.'
            },
            {
                title: 'VHS Nostalgia',
                desc: 'Retro video glitch effects',
                file: '/showcase/vhs-nostalgia.html',
                prompt: 'A VHS tape aesthetic with RGB shift that follows mouse, tracking glitches on click, scanlines, film grain, and a flickering timestamp.'
            },
            {
                title: 'Cosmic Nebula',
                desc: 'Birth of stars',
                file: '/showcase/cosmic-nebula.html',
                prompt: 'A cosmic nebula with 2000+ stars and swirling gas clouds that move toward the mouse. Click triggers a supernova explosion that creates new stars.'
            },
            {
                title: 'Typography Explosion',
                desc: 'Kinetic letters with physics',
                file: '/showcase/typography-explosion.html',
                prompt: 'Kinetic typography where letters are attracted to the mouse with physics. Click toggles between chaos mode and forming words. Letters have trails.'
            }
        ];

        const carousel = document.getElementById('carousel');
        showcaseExamples.forEach((ex, i) => {
            const card = document.createElement('div');
            card.className = 'carousel-card';
            card.innerHTML = `
                <div class="carousel-card-preview">
                    <iframe src="${ex.file}" sandbox="allow-scripts" loading="lazy"></iframe>
                </div>
                <div class="carousel-card-info">
                    <div class="carousel-card-title">${ex.title}</div>
                    <div class="carousel-card-desc">${ex.desc}</div>
                </div>
            `;
            card.addEventListener('click', () => {
                document.getElementById('promptInput').value = ex.prompt;
                updateCharCount();
                scrollToSection('generator');
            });
            carousel.appendChild(card);
        });

        // Animate carousel cards on scroll
        gsap.from('.carousel-card', {
            y: 60,
            opacity: 0,
            stagger: 0.1,
            duration: 0.8,
            ease: 'power2.out',
            scrollTrigger: {
                trigger: '#carousel',
                start: 'top 80%'
            }
        });

        // ============================================
        // GENERATOR STATE
        // ============================================
        let currentCode = '';
        let currentPrompt = '';
        let library = [];
        let editingId = null;

        // Load library from localStorage (v2 format)
        function loadLibrary() {
            try {
                const stored = localStorage.getItem('kinetic-library-v2');
                if (stored) {
                    library = JSON.parse(stored);
                } else {
                    // Migrate from v1 if exists
                    const v1 = localStorage.getItem('kinetic-library');
                    if (v1) {
                        library = JSON.parse(v1).map(item => ({
                            ...item,
                            thumbnail: null,
                            tags: [],
                            version: 2
                        }));
                        saveLibrary();
                    }
                }
            } catch (e) {
                library = [];
            }
        }

        function saveLibrary() {
            localStorage.setItem('kinetic-library-v2', JSON.stringify(library));
        }

        loadLibrary();

        // ============================================
        // PROMPT INPUT
        // ============================================
        const promptInput = document.getElementById('promptInput');
        const charCount = document.getElementById('charCount');

        function updateCharCount() {
            charCount.textContent = `${promptInput.value.length}/1000`;
        }

        promptInput.addEventListener('input', updateCharCount);

        // Suggestion pills
        document.querySelectorAll('.suggestion-pill').forEach(pill => {
            pill.addEventListener('click', () => {
                promptInput.value = pill.dataset.prompt;
                updateCharCount();
                promptInput.focus();
            });
        });

        // ============================================
        // RANDOM PROMPTS
        // ============================================
        const randomPrompts = [
            "A cosmic clock with orbiting planets as hour markers, each planet pulsing with light. The center has a spinning black hole effect.",
            "A forest of abstract trees made from vertical lines that wave like grass in wind. Birds made of simple triangles fly between them.",
            "An infinite tunnel of rotating hexagons that zoom toward the viewer. Each hexagon has a different shade creating a hypnotic gradient spiral.",
            "A flock of geometric birds (triangles) that follow the mouse cursor in a murmuration pattern. They leave trailing shadows as they move.",
            "A giant eye that blinks slowly, with the iris made of concentric rotating rings. The pupil follows the mouse.",
            "A cityscape silhouette with windows that light up randomly like a living organism. Clouds drift slowly across.",
            "A pendulum wave simulation with 15 swinging circles that create mesmerizing patterns as they go in and out of phase.",
            "A morphing blob that continuously transforms between different organic Matisse-inspired shapes.",
            "A constellation map where stars connect when you hover near them. The night sky slowly rotates. Shooting stars appear randomly.",
            "A kaleidoscope effect that uses geometric shapes instead of images. The pattern continuously evolves.",
            "A DNA helix that rotates in 3D space, with base pairs highlighted in different colors.",
            "A lava lamp with realistic blob physics. Blobs rise, merge, split, and sink.",
            "A bouncing DVD logo that changes color on corner hits. Celebration animation when it hits perfectly in the corner.",
            "A particle system explosion that resets every few seconds. Particles have gravity, trails, and fade out.",
            "A heartbeat monitor line that pulses across the screen. The heart rate increases on mouse movement.",
            "A snow globe scene with a tiny house inside. Shake effect on click releases swirling snow particles.",
            "An abstract face made of floating geometric features. The eyes follow the cursor.",
            "A spirograph drawing itself in real-time with glowing lines. Multiple overlapping patterns."
        ];

        document.getElementById('surpriseBtn').addEventListener('click', () => {
            const prompt = randomPrompts[Math.floor(Math.random() * randomPrompts.length)];
            promptInput.value = prompt;
            updateCharCount();

            // Visual feedback
            gsap.fromTo('#surpriseBtn',
                { scale: 0.95 },
                { scale: 1, duration: 0.3, ease: 'back.out(2)' }
            );
        });

        // ============================================
        // GENERATE ANIMATION
        // ============================================
        const generateBtn = document.getElementById('generateBtn');
        const previewIframe = document.getElementById('previewIframe');
        const previewEmpty = document.getElementById('previewEmpty');
        const skeletonLoader = document.getElementById('skeletonLoader');
        const actionBtns = {
            save: document.getElementById('saveBtn'),
            copy: document.getElementById('copyBtn'),
            download: document.getElementById('downloadBtn'),
            open: document.getElementById('openBtn')
        };

        generateBtn.addEventListener('click', async () => {
            const prompt = promptInput.value.trim();
            if (!prompt) {
                showToast('Please enter a prompt', 'error');
                return;
            }

            // Start loading
            generateBtn.classList.add('loading');
            generateBtn.disabled = true;
            previewEmpty.style.display = 'none';
            previewIframe.style.display = 'none';
            skeletonLoader.classList.add('active');

            try {
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt })
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error);

                currentCode = data.code;
                currentPrompt = prompt;

                // Show preview
                skeletonLoader.classList.remove('active');
                previewIframe.srcdoc = currentCode;
                previewIframe.style.display = 'block';

                // Enable action buttons
                Object.values(actionBtns).forEach(btn => btn.disabled = false);

                // Celebration!
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#7c3aed', '#06b6d4', '#ec4899']
                });

                showToast('Animation generated!', 'success');

            } catch (error) {
                skeletonLoader.classList.remove('active');
                previewEmpty.style.display = 'block';
                showToast(error.message || 'Generation failed', 'error');
            } finally {
                generateBtn.classList.remove('loading');
                generateBtn.disabled = false;
            }
        });

        // Keyboard shortcut
        promptInput.addEventListener('keydown', e => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                generateBtn.click();
            }
        });

        // ============================================
        // ACTION BUTTONS
        // ============================================
        actionBtns.save.addEventListener('click', () => {
            if (!currentCode) return;

            const item = {
                id: Date.now().toString(),
                name: `Animation ${library.length + 1}`,
                prompt: currentPrompt,
                code: currentCode,
                date: new Date().toISOString(),
                thumbnail: null,
                tags: [],
                version: 2
            };

            library.unshift(item);
            saveLibrary();
            renderGallery();
            showToast('Saved to library!', 'success');

            // Switch to gallery
            setTimeout(() => scrollToSection('gallery'), 500);
        });

        actionBtns.copy.addEventListener('click', () => {
            if (!currentCode) return;
            navigator.clipboard.writeText(currentCode);
            showToast('Copied to clipboard!', 'success');
        });

        actionBtns.download.addEventListener('click', () => {
            if (!currentCode) return;
            const blob = new Blob([currentCode], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'animation.html';
            a.click();
            URL.revokeObjectURL(url);
            showToast('Downloaded!', 'success');
        });

        actionBtns.open.addEventListener('click', () => {
            if (!currentCode) return;
            const blob = new Blob([currentCode], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            window.open(url, '_blank');
        });

        // ============================================
        // GALLERY
        // ============================================
        function renderGallery() {
            const grid = document.getElementById('galleryGrid');

            if (library.length === 0) {
                grid.innerHTML = `
                    <div class="gallery-empty">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10z"/>
                        </svg>
                        <h3>No saved animations yet</h3>
                        <p>Create and save animations to see them here</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = library.map(item => `
                <div class="gallery-card" data-id="${item.id}">
                    <div class="gallery-card-preview">
                        <iframe srcdoc="${escapeHtml(item.code)}" sandbox="allow-scripts"></iframe>
                    </div>
                    <div class="gallery-card-info">
                        <div class="gallery-card-title">
                            ${item.name}
                            <span class="gallery-card-date">${formatDate(item.date)}</span>
                        </div>
                        <div class="gallery-card-prompt">${item.prompt}</div>
                    </div>
                    <div class="gallery-card-actions">
                        <button class="gallery-action" data-action="load">Load</button>
                        <button class="gallery-action" data-action="rename">Rename</button>
                        <button class="gallery-action delete" data-action="delete">Delete</button>
                    </div>
                </div>
            `).join('');

            // Add event listeners
            grid.querySelectorAll('.gallery-card').forEach(card => {
                const id = card.dataset.id;

                card.querySelector('[data-action="load"]').addEventListener('click', () => loadFromLibrary(id));
                card.querySelector('[data-action="rename"]').addEventListener('click', () => openRenameModal(id));
                card.querySelector('[data-action="delete"]').addEventListener('click', () => openDeleteModal(id));
            });
        }

        function loadFromLibrary(id) {
            const item = library.find(i => i.id === id);
            if (!item) return;

            currentCode = item.code;
            currentPrompt = item.prompt;
            promptInput.value = item.prompt;
            updateCharCount();

            previewEmpty.style.display = 'none';
            previewIframe.srcdoc = item.code;
            previewIframe.style.display = 'block';

            Object.values(actionBtns).forEach(btn => btn.disabled = false);

            scrollToSection('generator');
            showToast(`Loaded "${item.name}"`, 'success');
        }

        function escapeHtml(str) {
            return str.replace(/&/g, '&amp;')
                      .replace(/</g, '&lt;')
                      .replace(/>/g, '&gt;')
                      .replace(/"/g, '&quot;');
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        // Initial render
        renderGallery();

        // Animate gallery cards on scroll
        ScrollTrigger.create({
            trigger: '#galleryGrid',
            start: 'top 80%',
            onEnter: () => {
                gsap.from('.gallery-card', {
                    y: 40,
                    opacity: 0,
                    stagger: 0.08,
                    duration: 0.6,
                    ease: 'power2.out'
                });
            },
            once: true
        });

        // ============================================
        // MODALS
        // ============================================
        const renameModal = document.getElementById('renameModal');
        const deleteModal = document.getElementById('deleteModal');
        const renameInput = document.getElementById('renameInput');

        function openRenameModal(id) {
            editingId = id;
            const item = library.find(i => i.id === id);
            renameInput.value = item.name;
            renameModal.classList.add('active');
            renameInput.focus();
        }

        function openDeleteModal(id) {
            editingId = id;
            deleteModal.classList.add('active');
        }

        document.getElementById('renameCancelBtn').addEventListener('click', () => {
            renameModal.classList.remove('active');
            editingId = null;
        });

        document.getElementById('renameConfirmBtn').addEventListener('click', () => {
            const newName = renameInput.value.trim();
            if (newName && editingId) {
                const item = library.find(i => i.id === editingId);
                if (item) {
                    item.name = newName;
                    saveLibrary();
                    renderGallery();
                    showToast('Renamed!', 'success');
                }
            }
            renameModal.classList.remove('active');
            editingId = null;
        });

        document.getElementById('deleteCancelBtn').addEventListener('click', () => {
            deleteModal.classList.remove('active');
            editingId = null;
        });

        document.getElementById('deleteConfirmBtn').addEventListener('click', () => {
            if (editingId) {
                library = library.filter(i => i.id !== editingId);
                saveLibrary();
                renderGallery();
                showToast('Deleted', 'success');
            }
            deleteModal.classList.remove('active');
            editingId = null;
        });

        // Close modals on overlay click
        [renameModal, deleteModal].forEach(modal => {
            modal.addEventListener('click', e => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                    editingId = null;
                }
            });
        });

        // Enter key for rename
        renameInput.addEventListener('keydown', e => {
            if (e.key === 'Enter') document.getElementById('renameConfirmBtn').click();
            if (e.key === 'Escape') document.getElementById('renameCancelBtn').click();
        });

        // ============================================
        // TOAST NOTIFICATIONS
        // ============================================
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const icon = type === 'success'
                ? '<svg class="toast-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg>'
                : '<svg class="toast-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>';

            toast.innerHTML = `${icon}<span>${message}</span>`;
            container.appendChild(toast);

            // Animate in
            requestAnimationFrame(() => toast.classList.add('show'));

            // Remove after delay
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ============================================
        // KEYBOARD SHORTCUTS
        // ============================================
        document.addEventListener('keydown', e => {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

            switch (e.key.toLowerCase()) {
                case 'g':
                    scrollToSection('generator');
                    break;
                case 'l':
                    scrollToSection('gallery');
                    break;
                case 'h':
                    scrollToSection('hero');
                    break;
            }
        });

        // ============================================
        // SECTION ANIMATIONS
        // ============================================
        gsap.utils.toArray('.section-header').forEach(header => {
            gsap.from(header, {
                y: 40,
                opacity: 0,
                duration: 0.8,
                ease: 'power2.out',
                scrollTrigger: {
                    trigger: header,
                    start: 'top 80%'
                }
            });
        });

        gsap.utils.toArray('.generator-panel').forEach((panel, i) => {
            gsap.from(panel, {
                y: 60,
                opacity: 0,
                duration: 0.8,
                delay: i * 0.2,
                ease: 'power2.out',
                scrollTrigger: {
                    trigger: '#generator',
                    start: 'top 60%'
                }
            });
        });
    </script>
</body>
</html>
